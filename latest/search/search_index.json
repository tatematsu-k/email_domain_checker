{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"EmailDomainChecker","text":"<p>Email address validation and domain checking library to prevent mail server reputation degradation.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>\u2705 Email format validation</li> <li>\u2705 Domain existence validation</li> <li>\u2705 MX record checking</li> <li>\u2705 A record checking</li> <li>\u2705 Email normalization</li> <li>\u2705 ActiveModel/ActiveRecord integration</li> <li>\u2705 DNS result caching (memory and Redis)</li> <li>\u2705 Test mode for development</li> </ul>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>require 'email_domain_checker'\n\n# Quick validation\nEmailDomainChecker.valid?(\"user@example.com\", validate_domain: false) # =&gt; true\n\n# Domain validation with MX records\nEmailDomainChecker.domain_valid?(\"user@example.com\", check_mx: true) # =&gt; true/false\n\n# Normalize email\nEmailDomainChecker.normalize(\"User@Example.COM\") # =&gt; \"user@example.com\"\n</code></pre>"},{"location":"#documentation","title":"Documentation","text":"<p>Please see the Getting Started guide for installation and setup instructions.</p>"},{"location":"#license","title":"License","text":"<p>The gem is available as open source under the terms of the MIT License.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Bug reports and pull requests are welcome on GitHub at https://github.com/tatematsu-k/email_domain_checker.</p>"},{"location":"contributing/#development","title":"Development","text":"<p>After checking out the repo, run <code>bin/setup</code> to install dependencies. Then, run <code>rake spec</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p> <p>To install this gem onto your local machine, run <code>bundle exec rake install</code>. To release a new version, update the version number in <code>version.rb</code>, and then run <code>bundle exec rake release</code>, which will create a git tag for the version, push git commits and the created tag, and push the <code>.gem</code> file to rubygems.org.</p>"},{"location":"configuration/cache/","title":"Cache Configuration","text":"<p>DNS validation results are cached by default using in-memory storage to improve performance when validating the same domains multiple times. The cache supports both in-memory storage (default) and Redis (optional).</p> <p>Production Recommendation</p> <p>While memory cache is enabled by default and works well for development and small applications, we recommend using Redis cache in production environments for better scalability, persistence across application restarts, and shared cache across multiple application instances.</p>"},{"location":"configuration/cache/#memory-cache-default-enabled-by-default","title":"Memory Cache (Default - Enabled by Default)","text":"<p>Cache is enabled by default - no configuration needed. Just use EmailDomainChecker normally and DNS results will be cached.</p>"},{"location":"configuration/cache/#customize-cache-ttl","title":"Customize Cache TTL","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.cache_ttl = 1800 # Cache entries expire after 30 minutes\nend\n</code></pre>"},{"location":"configuration/cache/#disable-cache","title":"Disable Cache","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.cache_enabled = false\nend\n</code></pre>"},{"location":"configuration/cache/#redis-cache-recommended-for-production","title":"Redis Cache (Recommended for Production)","text":"<p>For production environments, Redis cache is recommended for the following reasons:</p> <ul> <li>Persistence: Cache survives application restarts</li> <li>Scalability: Shared cache across multiple application instances</li> <li>Performance: Better memory management for large-scale applications</li> <li>Reliability: Handles cache eviction and expiration more efficiently</li> </ul>"},{"location":"configuration/cache/#setup","title":"Setup","text":"<p>First, add the <code>redis</code> gem to your Gemfile:</p> <pre><code>gem 'redis'\n</code></pre> <p>Then configure:</p> <pre><code># Enable Redis cache\nEmailDomainChecker.configure do |config|\n  config.cache_enabled = true\n  config.cache_type = :redis\n  config.cache_ttl = 3600\n  config.redis_client = Redis.new(url: \"redis://localhost:6379\")\nend\n</code></pre> <p>Fallback Behavior</p> <p>If Redis is not available, the gem will automatically fall back to memory cache.</p>"},{"location":"configuration/cache/#cache-management","title":"Cache Management","text":""},{"location":"configuration/cache/#clear-all-cache","title":"Clear All Cache","text":"<pre><code># Clear all cached DNS validation results\nEmailDomainChecker.clear_cache\n</code></pre>"},{"location":"configuration/cache/#clear-cache-for-specific-domain","title":"Clear Cache for Specific Domain","text":"<pre><code># Clear cache for a specific domain\nEmailDomainChecker.clear_cache_for_domain(\"example.com\")\n</code></pre>"},{"location":"configuration/cache/#cache-keys","title":"Cache Keys","text":"<p>Cache keys are automatically managed by the gem:</p> <ul> <li>MX records: <code>mx:example.com</code></li> <li>A records: <code>a:example.com</code></li> </ul>"},{"location":"configuration/cache/#using-with-method-rails-style-cache-interface","title":"Using <code>with</code> Method (Rails-style Cache Interface)","text":"<p>The cache adapters support a Rails-like <code>with</code> method (similar to <code>Rails.cache.fetch</code>) for convenient cache access. Cache is enabled by default, so you can use it immediately:</p> <pre><code># Method 1: Direct access via EmailDomainChecker.cache (recommended)\nresult = EmailDomainChecker.cache.with(\"my_key\", ttl: 3600) do\n  # This block executes only when cache misses\n  expensive_computation\nend\n\n# Method 2: Using convenience method\nresult = EmailDomainChecker.with_cache(\"my_key\", ttl: 3600) do\n  expensive_computation\nend\n\n# Force cache refresh\nresult = EmailDomainChecker.cache.with(\"my_key\", force: true) do\n  # This block always executes\n  updated_computation\nend\n\n# Or using convenience method\nresult = EmailDomainChecker.with_cache(\"my_key\", force: true) do\n  updated_computation\nend\n</code></pre>"},{"location":"configuration/cache/#custom-cache-adapter","title":"Custom Cache Adapter","text":"<p>You can implement your own cache adapter by inheriting from <code>EmailDomainChecker::Cache::BaseAdapter</code>:</p> <pre><code># Define a custom cache adapter\nclass MyCustomCacheAdapter &lt; EmailDomainChecker::Cache::BaseAdapter\n  def initialize\n    @store = {} # Your custom storage\n  end\n\n  def get(key)\n    # Your custom get logic\n    @store[key]\n  end\n\n  def set(key, value, ttl: nil)\n    # Your custom set logic\n    @store[key] = value\n  end\n\n  def delete(key)\n    # Your custom delete logic\n    @store.delete(key)\n  end\n\n  def clear\n    # Your custom clear logic\n    @store.clear\n  end\nend\n</code></pre>"},{"location":"configuration/cache/#using-custom-adapter-instance","title":"Using Custom Adapter Instance","text":"<pre><code># Use custom adapter instance\nEmailDomainChecker.configure do |config|\n  config.cache_enabled = true\n  config.cache_adapter_instance = MyCustomCacheAdapter.new\nend\n</code></pre>"},{"location":"configuration/cache/#using-custom-adapter-class","title":"Using Custom Adapter Class","text":"<pre><code># Or use custom adapter class (will be instantiated automatically)\nEmailDomainChecker.configure do |config|\n  config.cache_enabled = true\n  config.cache_type = MyCustomCacheAdapter\nend\n</code></pre> <p>Priority</p> <p>When both <code>cache_adapter_instance</code> and <code>cache_type</code> are set, the instance takes priority.</p>"},{"location":"configuration/options/","title":"Configuration Options","text":"<p>EmailDomainChecker supports various configuration options to customize its behavior.</p>"},{"location":"configuration/options/#available-options","title":"Available Options","text":""},{"location":"configuration/options/#validation-options","title":"Validation Options","text":"<ul> <li><code>validate_format</code>: Validate email format using email_address gem (default: <code>true</code>)</li> <li><code>validate_domain</code>: Validate domain existence (default: <code>true</code>)</li> <li><code>check_mx</code>: Check MX records for domain (default: <code>true</code>)</li> <li><code>check_a</code>: Check A records for domain (default: <code>false</code>)</li> <li><code>timeout</code>: DNS lookup timeout in seconds (default: <code>5</code>)</li> </ul>"},{"location":"configuration/options/#test-mode","title":"Test Mode","text":"<ul> <li><code>test_mode</code>: Skip DNS checks (useful for testing with dummy data) (default: <code>false</code>)</li> </ul> <p>When test mode is enabled, domain validation will always return <code>true</code> without making any DNS requests, allowing you to use dummy email addresses in your tests without external dependencies.</p>"},{"location":"configuration/options/#cache-options","title":"Cache Options","text":"<ul> <li><code>cache_enabled</code>: Enable/disable DNS validation result caching (default: <code>true</code> - memory cache is enabled by default)</li> <li><code>cache_type</code>: Cache adapter type (<code>:memory</code>, <code>:redis</code>, or a custom <code>BaseAdapter</code> class) (default: <code>:memory</code>)</li> <li><code>cache_adapter_instance</code>: Custom cache adapter instance (must inherit from <code>Cache::BaseAdapter</code>)</li> <li><code>cache_ttl</code>: Cache time-to-live in seconds (default: <code>3600</code>)</li> <li><code>redis_client</code>: Custom Redis client instance (only used when <code>cache_type</code> is <code>:redis</code>)</li> </ul>"},{"location":"configuration/options/#configuration-examples","title":"Configuration Examples","text":""},{"location":"configuration/options/#basic-configuration","title":"Basic Configuration","text":"<pre><code>EmailDomainChecker.configure(timeout: 10, check_mx: true)\n</code></pre>"},{"location":"configuration/options/#block-configuration","title":"Block Configuration","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.timeout = 10\n  config.check_mx = true\n  config.check_a = false\n  config.cache_ttl = 1800\nend\n</code></pre>"},{"location":"configuration/options/#test-mode-configuration","title":"Test Mode Configuration","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.test_mode = true\nend\n</code></pre>"},{"location":"configuration/options/#cache-configuration","title":"Cache Configuration","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.cache_enabled = true\n  config.cache_type = :memory\n  config.cache_ttl = 3600\nend\n</code></pre>"},{"location":"configuration/options/#note-on-cache-adapter-priority","title":"Note on Cache Adapter Priority","text":"<p>When both <code>cache_adapter_instance</code> and <code>cache_type</code> are set, the instance takes priority.</p>"},{"location":"configuration/test-mode/","title":"Test Mode","text":"<p>When writing tests, you may want to skip DNS checks to avoid external requests. Enable test mode to skip all DNS validations (MX and A record checks).</p>"},{"location":"configuration/test-mode/#enabling-test-mode","title":"Enabling Test Mode","text":""},{"location":"configuration/test-mode/#in-spec_helperrb-or-test_helperrb","title":"In spec_helper.rb or test_helper.rb","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.test_mode = true\nend\n</code></pre>"},{"location":"configuration/test-mode/#in-a-before-block","title":"In a before block","text":"<pre><code>before do\n  EmailDomainChecker::Config.test_mode = true\nend\n</code></pre>"},{"location":"configuration/test-mode/#behavior","title":"Behavior","text":"<p>When test mode is enabled, domain validation will always return <code>true</code> without making any DNS requests, allowing you to use dummy email addresses in your tests without external dependencies.</p>"},{"location":"configuration/test-mode/#example","title":"Example","text":"<pre><code># In spec_helper.rb\nEmailDomainChecker.configure do |config|\n  config.test_mode = true\nend\n\n# In your specs\nit \"validates email format\" do\n  expect(EmailDomainChecker.valid?(\"test@example.com\")).to be true\n  # Domain validation is skipped, but format validation still works\nend\n</code></pre>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#using-bundler","title":"Using Bundler","text":"<p>Add this line to your application's Gemfile:</p> <pre><code>gem 'email_domain_checker'\n</code></pre> <p>And then execute:</p> <pre><code>$ bundle install\n</code></pre>"},{"location":"getting-started/installation/#manual-installation","title":"Manual Installation","text":"<p>Or install it yourself as:</p> <pre><code>$ gem install email_domain_checker\n</code></pre>"},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>Ruby 3.0 or higher</li> <li>Optional: <code>redis</code> gem for Redis cache support</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":""},{"location":"getting-started/quick-start/#basic-usage","title":"Basic Usage","text":"<pre><code>require 'email_domain_checker'\n\n# Quick validation\nEmailDomainChecker.valid?(\"user@example.com\", validate_domain: false) # =&gt; true\n\n# Format validation only\nEmailDomainChecker.format_valid?(\"user@example.com\") # =&gt; true\n\n# Domain validation only\nEmailDomainChecker.domain_valid?(\"user@example.com\", check_mx: true) # =&gt; true/false\n\n# Normalize email\nEmailDomainChecker.normalize(\"User@Example.COM\") # =&gt; \"user@example.com\"\n</code></pre>"},{"location":"getting-started/quick-start/#configure-default-options","title":"Configure Default Options","text":"<pre><code># Configure default options globally\nEmailDomainChecker.configure(timeout: 10, check_mx: true)\n\n# Enable test mode (skips DNS checks)\nEmailDomainChecker.configure do |config|\n  config.test_mode = true\nend\n</code></pre>"},{"location":"getting-started/quick-start/#cache-configuration","title":"Cache Configuration","text":"<p>Cache is enabled by default (memory cache):</p> <pre><code># Cache is enabled by default - no configuration needed\n# Just use EmailDomainChecker normally and DNS results will be cached\n\n# Customize cache TTL if needed\nEmailDomainChecker.configure do |config|\n  config.cache_ttl = 1800 # Cache entries expire after 30 minutes\nend\n</code></pre> <p>For production environments, Redis cache is recommended. See Cache Configuration for details.</p>"},{"location":"usage/activemodel-integration/","title":"ActiveModel/ActiveRecord Integration","text":"<p>When ActiveModel is available, you can use the <code>DomainCheckValidator</code> for easy validation and normalization in your models.</p>"},{"location":"usage/activemodel-integration/#basic-usage","title":"Basic Usage","text":"<pre><code>class User &lt; ActiveRecord::Base\n  validates :email, domain_check: { check_mx: true, timeout: 3 }, normalize: true\nend\n</code></pre>"},{"location":"usage/activemodel-integration/#validator-options","title":"Validator Options","text":""},{"location":"usage/activemodel-integration/#domain_check-options","title":"<code>domain_check</code> Options","text":"<p>Hash of options for domain validation:</p> <ul> <li><code>check_mx</code>: Check MX records (default: <code>true</code>)</li> <li><code>check_a</code>: Check A records (default: <code>false</code>)</li> <li><code>timeout</code>: DNS query timeout in seconds (default: <code>5</code>)</li> <li><code>validate_format</code>: Validate email format (default: <code>true</code>)</li> <li><code>validate_domain</code>: Validate domain (default: <code>true</code>)</li> </ul>"},{"location":"usage/activemodel-integration/#other-options","title":"Other Options","text":"<ul> <li><code>normalize</code>: Normalize email before validation (default: <code>false</code>)</li> <li><code>message</code>: Custom error message</li> </ul>"},{"location":"usage/activemodel-integration/#examples","title":"Examples","text":""},{"location":"usage/activemodel-integration/#basic-validation-with-domain-check","title":"Basic Validation with Domain Check","text":"<pre><code>class User &lt; ActiveRecord::Base\n  validates :email, domain_check: { check_mx: true, timeout: 3 }\nend\n</code></pre>"},{"location":"usage/activemodel-integration/#format-validation-only","title":"Format Validation Only","text":"<p>Skip domain check and only validate format:</p> <pre><code>class User &lt; ActiveRecord::Base\n  validates :email, domain_check: { validate_domain: false }\nend\n</code></pre>"},{"location":"usage/activemodel-integration/#with-automatic-normalization","title":"With Automatic Normalization","text":"<p>Automatically normalize email addresses before validation:</p> <pre><code>class User &lt; ActiveRecord::Base\n  validates :email, domain_check: { check_mx: true }, normalize: true\nend\n</code></pre>"},{"location":"usage/activemodel-integration/#with-custom-error-message","title":"With Custom Error Message","text":"<p>Provide a custom error message:</p> <pre><code>class User &lt; ActiveRecord::Base\n  validates :email, domain_check: { check_mx: true }, message: \"Invalid email address\"\nend\n</code></pre>"},{"location":"usage/checker-class/","title":"Using Checker Class","text":"<p>The <code>EmailDomainChecker::Checker</code> class provides a more object-oriented approach to email validation.</p>"},{"location":"usage/checker-class/#basic-usage","title":"Basic Usage","text":"<pre><code>require 'email_domain_checker'\n\n# Basic validation\nchecker = EmailDomainChecker::Checker.new(\"user@example.com\")\nif checker.valid?\n  puts \"Valid email with valid domain\"\nend\n</code></pre>"},{"location":"usage/checker-class/#validation-methods","title":"Validation Methods","text":""},{"location":"usage/checker-class/#format-validation-only","title":"Format Validation Only","text":"<pre><code>checker = EmailDomainChecker::Checker.new(\"user@example.com\", validate_domain: false)\nchecker.format_valid? # =&gt; true\n</code></pre>"},{"location":"usage/checker-class/#domain-validation-with-mx-records","title":"Domain Validation with MX Records","text":"<pre><code>checker = EmailDomainChecker::Checker.new(\"user@example.com\", check_mx: true)\nchecker.domain_valid? # =&gt; true if MX records exist\n</code></pre>"},{"location":"usage/checker-class/#email-transformations","title":"Email Transformations","text":""},{"location":"usage/checker-class/#normalized-email","title":"Normalized Email","text":"<p>Get the normalized (lowercase) version of the email:</p> <pre><code>checker = EmailDomainChecker::Checker.new(\"User@Example.COM\")\nchecker.normalized_email # =&gt; \"user@example.com\"\n</code></pre>"},{"location":"usage/checker-class/#canonical-email","title":"Canonical Email","text":"<p>Get the canonical version of the email (handles Gmail-style aliases):</p> <pre><code>checker = EmailDomainChecker::Checker.new(\"user.name+tag@gmail.com\")\nchecker.canonical_email # =&gt; \"username@gmail.com\"\n</code></pre>"},{"location":"usage/checker-class/#redacted-email","title":"Redacted Email","text":"<p>Get a redacted version of the email for privacy (shows hash instead of local part):</p> <pre><code>checker = EmailDomainChecker::Checker.new(\"user@example.com\")\nchecker.redacted_email # =&gt; \"{hash}@example.com\"\n</code></pre>"},{"location":"usage/module-methods/","title":"Module-level Convenience Methods","text":"<p>The <code>EmailDomainChecker</code> module provides convenient class methods for quick validation and configuration.</p>"},{"location":"usage/module-methods/#validation-methods","title":"Validation Methods","text":""},{"location":"usage/module-methods/#valid","title":"<code>valid?</code>","text":"<p>Quick validation with optional domain checking:</p> <pre><code>EmailDomainChecker.valid?(\"user@example.com\", validate_domain: false) # =&gt; true\nEmailDomainChecker.valid?(\"user@example.com\", check_mx: true) # =&gt; true/false\n</code></pre>"},{"location":"usage/module-methods/#format_valid","title":"<code>format_valid?</code>","text":"<p>Validate email format only (skips domain validation):</p> <pre><code>EmailDomainChecker.format_valid?(\"user@example.com\") # =&gt; true\nEmailDomainChecker.format_valid?(\"invalid-email\") # =&gt; false\n</code></pre>"},{"location":"usage/module-methods/#domain_valid","title":"<code>domain_valid?</code>","text":"<p>Validate domain only (skips format validation):</p> <pre><code>EmailDomainChecker.domain_valid?(\"user@example.com\", check_mx: true) # =&gt; true/false\nEmailDomainChecker.domain_valid?(\"user@nonexistent.com\", check_mx: true) # =&gt; false\n</code></pre>"},{"location":"usage/module-methods/#utility-methods","title":"Utility Methods","text":""},{"location":"usage/module-methods/#normalize","title":"<code>normalize</code>","text":"<p>Normalize email address to lowercase:</p> <pre><code>EmailDomainChecker.normalize(\"User@Example.COM\") # =&gt; \"user@example.com\"\n</code></pre>"},{"location":"usage/module-methods/#configuration","title":"Configuration","text":""},{"location":"usage/module-methods/#global-configuration","title":"Global Configuration","text":"<pre><code>EmailDomainChecker.configure(timeout: 10, check_mx: true)\n</code></pre>"},{"location":"usage/module-methods/#block-configuration","title":"Block Configuration","text":"<pre><code>EmailDomainChecker.configure do |config|\n  config.test_mode = true\n  config.cache_ttl = 3600\n  config.cache_enabled = true\nend\n</code></pre>"},{"location":"usage/module-methods/#cache-management","title":"Cache Management","text":""},{"location":"usage/module-methods/#clear-all-cache","title":"Clear All Cache","text":"<pre><code>EmailDomainChecker.clear_cache\n</code></pre>"},{"location":"usage/module-methods/#clear-cache-for-specific-domain","title":"Clear Cache for Specific Domain","text":"<pre><code>EmailDomainChecker.clear_cache_for_domain(\"example.com\")\n</code></pre>"},{"location":"usage/module-methods/#using-cache-with-blocks","title":"Using Cache with Blocks","text":"<pre><code># Method 1: Direct access via EmailDomainChecker.cache (recommended)\nresult = EmailDomainChecker.cache.with(\"my_key\", ttl: 3600) do\n  # This block executes only when cache misses\n  expensive_computation\nend\n\n# Method 2: Using convenience method\nresult = EmailDomainChecker.with_cache(\"my_key\", ttl: 3600) do\n  expensive_computation\nend\n\n# Force cache refresh\nresult = EmailDomainChecker.with_cache(\"my_key\", force: true) do\n  # This block always executes\n  updated_computation\nend\n</code></pre>"}]}